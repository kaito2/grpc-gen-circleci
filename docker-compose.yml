version: "3"
services:
    lint:
        image: namely/protoc-all:1.16_0
        volumes:
            - .:/defs
        entrypoint: "sh -c"
        command: '"protoc -I/usr/local/include -I. --lint_out=. ./protos/*.proto"'
    go:
        image: namely/protoc-all:1.16_0
        volumes:
            - .:/defs
        command: "-d ./protos -o ./pb-go --with-docs markdown,readme.md -l go"
    python:
        image: namely/protoc-all:1.16_0
        volumes:
            - .:/defs
        command: "-d ./protos -o ./pb-python --with-docs markdown,readme.md -l python"
    typescript:
        image: node:8
        volumes:
        - .:/grpc-gen
        command: 'sh -c
        "cd grpc-gen
        && npm install grpc-tools --no-save grpc_tools_node_protoc_ts
        && bash protoc.sh"'
